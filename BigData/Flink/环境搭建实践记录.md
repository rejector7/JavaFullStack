# Flink环境搭建实践记录

根据不同的flink版本，操作系统，运行环境等，本人尝试了多种环境搭建方式，
搭建过程和结果记录如下。

## flink1.14.4（当前最新版）+ windows10 + 本地jdk&maven&项目文件


## flink1.10.0 + windows10 + 本地jdk&maven&项目文件

1. Idea新建flink项目，使用flink-quickstart-archetype快速创建。
   1. 设置好archetype，version等信息。
   2. 设置本地jdk1.8，Bundled Maven等。

**问题1.1：Cannot resolve plugin org.apache.maven.plugins:maven-compiler-plugin:3.1.1**

参考连接：
https://blog.csdn.net/Y_eatMeat/article/details/123329692

解决方式：
修改setting.xml，引入阿里云镜像，flink运行时完整settings.xml见同目录版本。
在idea-settings-maven中，选择override settings.xml


**问题1.2：maven-shade-plugin can not found**

虽然在pom中已经引入插件，但还是无法找到。

解决方式：

maven repo中找到依赖并引入<dependency>而不是插件，reload。
```text
<dependency>
<groupId>org.apache.maven.plugins</groupId>
<artifactId>maven-shade-plugin</artifactId>
<version>3.1.1</version>
</dependency>
```

2. 运行默认文件BatchJob。

问题2.1， 2.2的解决方式参考连接：
https://whiteccinn.github.io/2021/09/28/%E5%A4%A7%E6%95%B0%E6%8D%AE/flink%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/

**问题2.1：need sink**

即任务需要输出或打印。

解决方式：

修改默认文件BatchJob。

```text
DataSource<String> el = env.fromElements("good good study", "day day up");
el.flatMap(
    (String a, Collector<String> out) -> Arrays.stream(a.split(" ")).forEach(x -> out.collect(x))
).returns(String.class).print();
```

**问题2.2：类无定义**

```text
Exception in thread "main" java.lang.NoClassDefFoundError: org/apache/flink/api/java/ExecutionEnvironment
	at my.flink.BatchJob.main(BatchJob.java:41)
```

解决方式：

修改<groupId>org.apache.flink</groupId>的依赖包的<scope>

注释掉或者改为<compile>,而不是<provided>

reload，运行后输出正常，仍有异常。

**问题3：无new sink**

```text
No new data sinks have been defined since the last execution
```

参考连接：
https://blog.csdn.net/lz6363/article/details/112575146

解决方式：
注释掉最后一行execute。

BatchJob运行成功。